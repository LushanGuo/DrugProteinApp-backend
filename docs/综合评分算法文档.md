# è¯ç‰©ç­›é€‰å¹³å° - ç»¼åˆè¯„åˆ†ç®—æ³•å®Œæ•´æ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [ç®—æ³•æ¦‚è¿°](#ç®—æ³•æ¦‚è¿°)
2. [è¯„åˆ†ä½“ç³»æ¶æ„](#è¯„åˆ†ä½“ç³»æ¶æ„)
3. [ä¸‰å¤§æ ¸å¿ƒæ¨¡å—](#ä¸‰å¤§æ ¸å¿ƒæ¨¡å—)
4. [ç†”æ–­æœºåˆ¶](#ç†”æ–­æœºåˆ¶)
5. [è¯„åˆ†è§„åˆ™è¯¦è§£](#è¯„åˆ†è§„åˆ™è¯¦è§£)
6. [çŸ¥è¯†åº“](#çŸ¥è¯†åº“)
7. [ç®—æ³•å®ç°](#ç®—æ³•å®ç°)
8. [è¯„åˆ†ç¤ºä¾‹](#è¯„åˆ†ç¤ºä¾‹)

---

## ç®—æ³•æ¦‚è¿°

### è®¾è®¡ç†å¿µ

æœ¬ç®—æ³•é‡‡ç”¨**å¤šç»´åº¦åŠ æƒè¯„åˆ† + å®‰å…¨ç†”æ–­æœºåˆ¶**ï¼Œæ¨¡æ‹ŸçœŸå®è¯ç‰©ç ”å‘ä¸­çš„å†³ç­–æµç¨‹ï¼š

```
æ€»åˆ† (0-100) = æ•ˆèƒ½åˆ† (45%) + å®‰å…¨åˆ† (35%) + æˆè¯æ€§ (20%)
```

**æ ¸å¿ƒç‰¹ç‚¹ï¼š**
- âœ… **å®‰å…¨ä¼˜å…ˆ**ï¼šhERG å¿ƒè„æ¯’æ€§ä¸€ç¥¨å¦å†³
- âœ… **ç§‘å­¦åŠ æƒ**ï¼šåŸºäºè¯ç‰©ç ”å‘å®é™…ä¼˜å…ˆçº§
- âœ… **åŠ¨æ€è¯„ä¼°**ï¼šæ”¯æŒå¤šç§åˆ†å­å±æ€§ç»¼åˆåˆ¤æ–­
- âœ… **å¯è§£é‡Šæ€§**ï¼šç”Ÿæˆè¯¦ç»†çš„ä¸“å®¶å»ºè®®å’Œæ ‡ç­¾

### ç®—æ³•æµç¨‹å›¾

```
å¼€å§‹
  â†“
è·å–åŒ–åˆç‰©æ•°æ®
  â†“
æ£€æŸ¥ hERG æ¯’æ€§ (>0.7?)
  â”œâ”€ æ˜¯ â†’ è§¦å‘ç†”æ–­ â†’ æ€»åˆ†=0 â†’ è¿”å›è­¦å‘Š
  â””â”€ å¦ â†’ ç»§ç»­è¯„åˆ†
       â†“
    è®¡ç®—å®‰å…¨åˆ† (35%)
       â†“
    è®¡ç®—æ•ˆèƒ½åˆ† (45%)
       â†“
    è®¡ç®—æˆè¯æ€§ (20%)
       â†“
    æ±‡æ€»æ€»åˆ†
       â†“
    ç”Ÿæˆæ ‡ç­¾å’Œå»ºè®®
       â†“
    ä¿å­˜æŠ¥å‘Š
       â†“
    è¿”å›ç»“æœ
```

---

## è¯„åˆ†ä½“ç³»æ¶æ„

### æƒé‡åˆ†é…

| æ¨¡å— | æƒé‡ | æœ€é«˜åˆ† | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|------|--------|--------|------|
| **å®‰å…¨æ€§ (Safety)** | 35% | 35 åˆ† | ğŸ”´ æœ€é«˜ | åŒ…å«ç†”æ–­æœºåˆ¶ |
| **æ•ˆèƒ½ (Potency)** | 45% | 45 åˆ† | ğŸŸ¡ é«˜ | ç”Ÿç‰©æ´»æ€§è¯„ä¼° |
| **æˆè¯æ€§ (Drug-Likeness)** | 20% | 20 åˆ† | ğŸŸ¢ ä¸­ | ç†åŒ–æ€§è´¨ |

### è¯„åˆ†ç­‰çº§

| æ€»åˆ†èŒƒå›´ | ç­‰çº§ | é¢œè‰² | å»ºè®® |
|---------|------|------|------|
| 80-100 | ä¼˜ç§€ | ğŸŸ¢ ç»¿è‰² | ä¼˜å…ˆè¿›è¡Œå®éªŒéªŒè¯ |
| 70-79 | è‰¯å¥½ | ğŸŸ¡ é»„è‰² | å¯è€ƒè™‘è¿›ä¸€æ­¥ç ”ç©¶ |
| 60-69 | ä¸­ç­‰ | ğŸŸ  æ©™è‰² | éœ€è¦ç»“æ„ä¼˜åŒ– |
| 0-59 | è¾ƒä½ | ğŸ”´ çº¢è‰² | ä¸å»ºè®®ä½œä¸ºå€™é€‰è¯ç‰© |
| 0 (ç†”æ–­) | ç»ˆæ­¢ | â›” é»‘è‰² | ä¸¥é‡å®‰å…¨é£é™©ï¼Œç»ˆæ­¢å¼€å‘ |

---

## ä¸‰å¤§æ ¸å¿ƒæ¨¡å—

### æ¨¡å—ä¸€ï¼šå®‰å…¨æ€§è¯„ä¼° (Safety) - 35%

**è®¾è®¡åŸåˆ™ï¼š** å®‰å…¨æ€§æ˜¯è¯ç‰©å¼€å‘çš„ç”Ÿå‘½çº¿ï¼Œé‡‡ç”¨"ä¸€ç¥¨å¦å†³åˆ¶"ã€‚

#### 1.1 hERG å¿ƒè„æ¯’æ€§ (15åˆ† + ç†”æ–­)

**èƒŒæ™¯çŸ¥è¯†ï¼š**
- hERG (human Ether-Ã -go-go-Related Gene) æ˜¯å¿ƒè„é’¾ç¦»å­é€šé“
- é˜»æ–­ hERG ä¼šå¯¼è‡´ QT é—´æœŸå»¶é•¿ï¼Œå¼•å‘è‡´å‘½æ€§å¿ƒå¾‹å¤±å¸¸
- å†å²ä¸Šå¤šä¸ªè¯ç‰©å›  hERG æ¯’æ€§è¢«æ’¤å¸‚ï¼ˆå¦‚ï¼šç‰¹éé‚£å®šã€è¥¿æ²™å¿…åˆ©ï¼‰

**è¯„åˆ†è§„åˆ™ï¼š**

| hERG æ¦‚ç‡ | å¾—åˆ† | æ ‡ç­¾ | è¯´æ˜ |
|-----------|------|------|------|
| > 0.7 | **ç†”æ–­** | â›” hERGé«˜å±ç†”æ–­ | ç«‹å³ç»ˆæ­¢ï¼Œæ€»åˆ†å½’é›¶ |
| 0.3 - 0.7 | 5 åˆ† | hERGé£é™©ä¸­ç­‰ | éœ€è¦è¿›ä¸€æ­¥éªŒè¯ |
| < 0.3 | 15 åˆ† | âœ… å¿ƒè„å®‰å…¨æ€§ä½³ | é€šè¿‡å®‰å…¨æ£€æŸ¥ |

**ç†”æ–­è§¦å‘æ¡ä»¶ï¼š**
```java
if (hergProbability > 0.7) {
    totalScore = 0;
    isVetoed = true;
    return "ä¸¥é‡è­¦å‘Šï¼šhERG å¿ƒè„æ¯’æ€§é£é™©è¿‡é«˜";
}
```

#### 1.2 AMES è‡´çªå˜æ€§ (10åˆ†)

**èƒŒæ™¯çŸ¥è¯†ï¼š**
- AMES æµ‹è¯•ç”¨äºæ£€æµ‹åŒ–åˆç‰©çš„è‡´çªå˜æ€§
- é˜³æ€§ç»“æœè¡¨æ˜å¯èƒ½å…·æœ‰è‡´ç™Œé£é™©
- FDA è¦æ±‚æ‰€æœ‰æ–°è¯å¿…é¡»é€šè¿‡ AMES æµ‹è¯•

**è¯„åˆ†è§„åˆ™ï¼š**

| AMES ç»“æœ | å¾—åˆ† | æ ‡ç­¾ |
|-----------|------|------|
| é˜´æ€§ (false) | 10 åˆ† | âœ… æ— è‡´çªå˜é£é™© |
| é˜³æ€§ (true) | 0 åˆ† | âš ï¸ è‡´çªå˜é£é™© |

#### 1.3 è‚æ¯’æ€§ (DILI) (10åˆ†)

**èƒŒæ™¯çŸ¥è¯†ï¼š**
- DILI (Drug-Induced Liver Injury) æ˜¯è¯ç‰©æ’¤å¸‚çš„ä¸»è¦åŸå› ä¹‹ä¸€
- çº¦å è¯ç‰©ä¸è‰¯ååº”çš„ 10%
- ä¸¥é‡è‚æŸä¼¤å¯å¯¼è‡´è‚è¡°ç«­

**è¯„åˆ†è§„åˆ™ï¼š**

| è‚æ¯’æ€§é¢„æµ‹ | å¾—åˆ† | æ ‡ç­¾ |
|-----------|------|------|
| æ— é£é™© (false) | 10 åˆ† | âœ… è‚è„å®‰å…¨ |
| æœ‰é£é™© (true) | 0 åˆ† | âš ï¸ è‚æ¯’æ€§é£é™© |

---

### æ¨¡å—äºŒï¼šæ•ˆèƒ½è¯„ä¼° (Potency) - 45%

**è®¾è®¡åŸåˆ™ï¼š** è¯„ä¼°åŒ–åˆç‰©ä¸é¶æ ‡çš„ç»“åˆèƒ½åŠ›å’Œç”Ÿç‰©æ´»æ€§ã€‚

#### 2.1 åˆ†å­å¯¹æ¥äº²å’ŒåŠ› (30åˆ†)

**èƒŒæ™¯çŸ¥è¯†ï¼š**
- ä½¿ç”¨ AutoDock Vina è®¡ç®—ç»“åˆè‡ªç”±èƒ½ (kcal/mol)
- æ•°å€¼è¶Šè´Ÿï¼Œç»“åˆè¶Šå¼º
- å…¸å‹èŒƒå›´ï¼š-6 åˆ° -12 kcal/mol

**è¯„åˆ†è§„åˆ™ï¼ˆçº¿æ€§æ’å€¼ï¼‰ï¼š**

| äº²å’ŒåŠ› (kcal/mol) | å¾—åˆ† | æ ‡ç­¾ | è¯´æ˜ |
|-------------------|------|------|------|
| â‰¤ -10.0 | 30 åˆ† | ğŸŒŸ æå¼ºç»“åˆ | ä¼˜ç§€çš„ç»“åˆèƒ½åŠ› |
| -10.0 ~ -6.0 | çº¿æ€§æ’å€¼ | - | æŒ‰æ¯”ä¾‹è®¡ç®— |
| > -6.0 | 0 åˆ† | ç»“åˆåŠ›å¼± | ä¸æ¨è |

**è®¡ç®—å…¬å¼ï¼š**
```java
if (affinity <= -10.0) {
    score = 30.0;
} else if (affinity > -6.0) {
    score = 0.0;
} else {
    // çº¿æ€§æ’å€¼
    score = 30.0 * (affinity - (-6.0)) / (-10.0 - (-6.0));
    // ä¾‹å¦‚ï¼šaffinity = -8.0
    // score = 30 * (-8 - (-6)) / (-4) = 30 * (-2) / (-4) = 15.0
}
```

**ç¤ºä¾‹ï¼š**
- affinity = -9.2 â†’ score = 24.0 åˆ†
- affinity = -8.0 â†’ score = 15.0 åˆ†
- affinity = -7.0 â†’ score = 7.5 åˆ†

#### 2.2 ç»“æ„ç›¸ä¼¼æ€§ (10åˆ†)

**èƒŒæ™¯çŸ¥è¯†ï¼š**
- ä½¿ç”¨ Tanimoto ç³»æ•°è¡¡é‡ä¸å·²çŸ¥æ´»æ€§åŒ–åˆç‰©çš„ç›¸ä¼¼åº¦
- èŒƒå›´ï¼š0 (å®Œå…¨ä¸åŒ) åˆ° 1 (å®Œå…¨ç›¸åŒ)
- å‚è€ƒåŒ–åˆç‰©ï¼šPalbociclib (CDK2 æŠ‘åˆ¶å‰‚)

**è¯„åˆ†è§„åˆ™ï¼š**

| Tanimoto ç³»æ•° | å¾—åˆ† | æ ‡ç­¾ | è¯´æ˜ |
|---------------|------|------|------|
| â‰¥ 0.7 | 10 åˆ† | éª¨æ¶æˆç†Ÿ | ç±»ä¼¼å·²çŸ¥æ´»æ€§åŒ–åˆç‰© |
| 0.5 - 0.7 | 5 åˆ† | - | ä¸­ç­‰ç›¸ä¼¼åº¦ |
| < 0.5 | 2 åˆ† | ğŸ’¡ éª¨æ¶æ–°é¢– | é¼“åŠ±åˆ›æ–°ç»“æ„ |

**è®¾è®¡ç†å¿µï¼š**
- é«˜ç›¸ä¼¼åº¦ï¼šå®‰å…¨æ€§æ›´å¯é¢„æµ‹
- ä½ç›¸ä¼¼åº¦ï¼šå¯èƒ½å‘ç°æ–°å‹éª¨æ¶ï¼ˆç»™äºˆåŸºç¡€åˆ†é¼“åŠ±åˆ›æ–°ï¼‰

#### 2.3 é…ä½“æ•ˆç‡ (LE) (5åˆ†)

**èƒŒæ™¯çŸ¥è¯†ï¼š**
- LE (Ligand Efficiency) = -Î”G / é‡åŸå­æ•°
- è¡¡é‡æ¯ä¸ªåŸå­å¯¹ç»“åˆèƒ½çš„è´¡çŒ®
- ä¼˜ç§€è¯ç‰©çš„ LE é€šå¸¸ > 0.3

**è¯„åˆ†è§„åˆ™ï¼š**

| LE å€¼ | å¾—åˆ† | æ ‡ç­¾ |
|-------|------|------|
| â‰¥ 0.3 | 5 åˆ† | âœ… é«˜é…ä½“æ•ˆç‡ |
| < 0.3 | 0 åˆ† | - |

**è®¡ç®—å…¬å¼ï¼š**
```java
LE = -affinity / heavyAtomCount
// ä¾‹å¦‚ï¼šaffinity = -9.0, heavyAtoms = 25
// LE = 9.0 / 25 = 0.36 â†’ å¾— 5 åˆ†
```

---

### æ¨¡å—ä¸‰ï¼šæˆè¯æ€§è¯„ä¼° (Drug-Likeness) - 20%

**è®¾è®¡åŸåˆ™ï¼š** åŸºäº Lipinski äº”è§„åˆ™å’Œè¯ç‰©åŒ–å­¦ç»éªŒã€‚

#### 3.1 è„‚æ°´åˆ†é…ç³»æ•° (LogP) (10åˆ†)

**èƒŒæ™¯çŸ¥è¯†ï¼š**
- LogP è¡¡é‡åŒ–åˆç‰©çš„äº²è„‚æ€§
- å½±å“è¯ç‰©çš„å¸æ”¶ã€åˆ†å¸ƒã€ä»£è°¢
- ç†æƒ³èŒƒå›´ï¼š0-3ï¼ˆå£æœè¯ç‰©ï¼‰

**è¯„åˆ†è§„åˆ™ï¼š**

| LogP èŒƒå›´ | å¾—åˆ† | è¯´æ˜ |
|-----------|------|------|
| 0 - 3 | 10 åˆ† | âœ… æœ€ä½³èŒƒå›´ |
| 3 - 4 æˆ– -1 - 0 | 6 åˆ† | å¯æ¥å— |
| < -1 æˆ– > 4 | 0 åˆ† | âš ï¸ LogPä¸ä½³ |

**è¯ç†æ„ä¹‰ï¼š**
- LogP è¿‡ä½ï¼šéš¾ä»¥ç©¿é€ç»†èƒè†œ
- LogP è¿‡é«˜ï¼šæº¶è§£åº¦å·®ï¼Œæ˜“åœ¨è„‚è‚ªç»„ç»‡è“„ç§¯

#### 3.2 åˆ†å­é‡ (MW) (5åˆ†)

**èƒŒæ™¯çŸ¥è¯†ï¼š**
- Lipinski è§„åˆ™ï¼šMW < 500 Da
- å£æœè¯ç‰©çš„å…¸å‹èŒƒå›´ï¼š300-500 Da

**è¯„åˆ†è§„åˆ™ï¼š**

| åˆ†å­é‡ (Da) | å¾—åˆ† | è¯´æ˜ |
|-------------|------|------|
| 300 - 500 | 5 åˆ† | âœ… ç†æƒ³èŒƒå›´ |
| 250 - 300 æˆ– 500 - 550 | 3 åˆ† | å¯æ¥å— |
| < 250 æˆ– > 550 | 0 åˆ† | ä¸æ¨è |

#### 3.3 æ°¢é”®ä¾›ä½“/å—ä½“ (HBD/HBA) (5åˆ†)

**èƒŒæ™¯çŸ¥è¯†ï¼š**
- Lipinski è§„åˆ™ï¼šHBD â‰¤ 5, HBA â‰¤ 10
- å½±å“æ°´æº¶æ€§å’Œè†œé€šé€æ€§

**è¯„åˆ†è§„åˆ™ï¼š**

| æ¡ä»¶ | å¾—åˆ† |
|------|------|
| HBD â‰¤ 5 ä¸” HBA â‰¤ 10 | 5 åˆ† |
| å…¶ä»– | 2 åˆ† |

---

## ç†”æ–­æœºåˆ¶

### è®¾è®¡ç†å¿µ

**"ä¸€ç¥¨å¦å†³åˆ¶"** - æ¨¡æ‹ŸçœŸå®è¯ç‰©å¼€å‘ä¸­çš„å®‰å…¨å†³ç­–ï¼š
- å³ä½¿å…¶ä»–æŒ‡æ ‡ä¼˜ç§€ï¼Œåªè¦è§¦å‘ç†”æ–­æ¡ä»¶ï¼Œç«‹å³ç»ˆæ­¢
- é¿å…å°†é«˜é£é™©åŒ–åˆç‰©æ¨è¿›åˆ°ä¸´åºŠé˜¶æ®µ
- èŠ‚çœç ”å‘æˆæœ¬å’Œæ—¶é—´

### ç†”æ–­è§¦å‘æ¡ä»¶

| æŒ‡æ ‡ | é˜ˆå€¼ | åæœ |
|------|------|------|
| hERG æ¦‚ç‡ | > 0.7 | æ€»åˆ†å½’é›¶ï¼Œç»ˆæ­¢å¼€å‘ |

### ç†”æ–­å“åº”

```json
{
  "compoundId": 1,
  "totalScore": 0.0,
  "isVetoed": true,
  "adviceTags": ["â›” hERGé«˜å±ç†”æ–­"],
  "expertAdvice": "âŒ ä¸¥é‡è­¦å‘Šï¼šè¯¥åˆ†å­ hERG å¿ƒè„æ¯’æ€§é¢„æµ‹æ¦‚ç‡è¿‡é«˜ (>0.7)ï¼Œå­˜åœ¨è‡´æ­»æ€§å¿ƒå¾‹å¤±å¸¸é£é™©ã€‚æ ¹æ®å®‰å…¨ä¸€ç¥¨å¦å†³åˆ¶ï¼Œç³»ç»Ÿå·²è‡ªåŠ¨ç»ˆæ­¢è¯¥åˆ†å­çš„å¼€å‘æµç¨‹ã€‚"
}
```

### å‰ç«¯å±•ç¤º

- ğŸ”´ çº¢è‰²è­¦å‘Šé¡µé¢
- â›” é†’ç›®çš„ç†”æ–­å›¾æ ‡
- ğŸ“‹ è¯¦ç»†çš„é£é™©è¯´æ˜
- ğŸš« ç¦æ­¢è¿›å…¥ä¸‹ä¸€æ­¥æµç¨‹

---

## è¯„åˆ†è§„åˆ™è¯¦è§£

### çº¿æ€§æ’å€¼ç®—æ³•

ç”¨äºäº²å’ŒåŠ›è¯„åˆ†çš„å¹³æ»‘è¿‡æ¸¡ï¼š

```
å…¬å¼ï¼šScore = MaxScore Ã— (Value - Min) / (Max - Min)

ç¤ºä¾‹ï¼ˆäº²å’ŒåŠ›ï¼‰ï¼š
- æœ€å¤§å€¼ï¼š-10.0 kcal/mol â†’ 30 åˆ†
- æœ€å°å€¼ï¼š-6.0 kcal/mol â†’ 0 åˆ†
- å½“å‰å€¼ï¼š-8.0 kcal/mol

è®¡ç®—ï¼š
Score = 30 Ã— (-8.0 - (-6.0)) / (-10.0 - (-6.0))
      = 30 Ã— (-2.0) / (-4.0)
      = 30 Ã— 0.5
      = 15.0 åˆ†
```

### é˜ˆå€¼åˆ¤æ–­

ç”¨äºäºŒå…ƒæˆ–å¤šçº§è¯„åˆ†ï¼š

```java
// ç¤ºä¾‹ï¼šLogP è¯„åˆ†
if (logP >= 0 && logP <= 3) {
    score = 10.0;  // æœ€ä½³èŒƒå›´
} else if ((logP > 3 && logP <= 4) || (logP >= -1 && logP < 0)) {
    score = 6.0;   // å¯æ¥å—èŒƒå›´
} else {
    score = 0.0;   // ä¸æ¨è
}
```

### æ ‡ç­¾ç”Ÿæˆè§„åˆ™

**ä¼˜ç‚¹æ ‡ç­¾ï¼ˆGood Tagsï¼‰ï¼š**
- äº²å’ŒåŠ› â‰¥ 80% â†’ "ğŸŒŸ æå¼ºç»“åˆ"
- å®‰å…¨åˆ† â‰¥ 30 â†’ "å¿ƒè„å®‰å…¨æ€§ä½³"
- LogP åœ¨ 1-4 â†’ "è„‚æº¶æ€§é€‚å®œ"
- MW åœ¨ 200-450 â†’ "åˆ†å­é‡é€‚ä¸­"

**ç¼ºç‚¹æ ‡ç­¾ï¼ˆBad Tagsï¼‰ï¼š**
- hERG > 0.3 â†’ "hERGé£é™©ä¸­ç­‰"
- AMES é˜³æ€§ â†’ "è‡´çªå˜é£é™©"
- LogP > 5 â†’ "LogPä¸ä½³"
- MW > 600 â†’ "åˆ†å­é‡è¿‡å¤§"

---

## çŸ¥è¯†åº“

### è¯ç‰©åŒ–å­¦åŸºç¡€

#### Lipinski äº”è§„åˆ™ (Rule of Five)

å£æœè¯ç‰©åº”æ»¡è¶³ï¼š
1. åˆ†å­é‡ < 500 Da
2. LogP < 5
3. æ°¢é”®ä¾›ä½“ (HBD) â‰¤ 5
4. æ°¢é”®å—ä½“ (HBA) â‰¤ 10
5. å¯æ—‹è½¬é”® < 10

#### é…ä½“æ•ˆç‡ (Ligand Efficiency)

```
LE = -Î”G / é‡åŸå­æ•°
```

**ä¼˜ç§€è¯ç‰©çš„ LE æ ‡å‡†ï¼š**
- LE > 0.3ï¼šä¼˜ç§€
- LE = 0.25-0.3ï¼šè‰¯å¥½
- LE < 0.25ï¼šéœ€è¦ä¼˜åŒ–

#### åˆ†å­å¯¹æ¥è¯„åˆ†

**AutoDock Vina ç»“åˆèƒ½èŒƒå›´ï¼š**
- -12 ~ -10 kcal/molï¼šæå¼ºç»“åˆ
- -10 ~ -8 kcal/molï¼šå¼ºç»“åˆ
- -8 ~ -6 kcal/molï¼šä¸­ç­‰ç»“åˆ
- > -6 kcal/molï¼šå¼±ç»“åˆ

### ADMET çŸ¥è¯†åº“

#### hERG å¿ƒè„æ¯’æ€§

**å†å²æ¡ˆä¾‹ï¼š**
- **ç‰¹éé‚£å®š (Terfenadine)**ï¼š1997å¹´æ’¤å¸‚ï¼Œå¯¼è‡´å°–ç«¯æ‰­è½¬å‹å®¤æ€§å¿ƒåŠ¨è¿‡é€Ÿ
- **è¥¿æ²™å¿…åˆ© (Cisapride)**ï¼š2000å¹´æ’¤å¸‚ï¼ŒQTé—´æœŸå»¶é•¿
- **é˜¿å¸å’ªå”‘ (Astemizole)**ï¼š1999å¹´æ’¤å¸‚ï¼Œå¿ƒå¾‹å¤±å¸¸

**é£é™©ç­‰çº§ï¼š**
- é«˜é£é™©ï¼šhERG IC50 < 1 Î¼M
- ä¸­é£é™©ï¼š1-10 Î¼M
- ä½é£é™©ï¼š> 10 Î¼M

#### AMES è‡´çªå˜æ€§

**æµ‹è¯•åŸç†ï¼š**
ä½¿ç”¨é¼ ä¼¤å¯’æ²™é—¨æ°èŒæ£€æµ‹åŒ–åˆç‰©çš„è‡´çªå˜æ€§

**é˜³æ€§åŒ–åˆç‰©ç±»å‹ï¼š**
- å¤šç¯èŠ³çƒƒ
- èŠ³é¦™èƒº
- äºšç¡èƒº
- ç¯æ°§åŒ–ç‰©

#### è‚æ¯’æ€§ (DILI)

**é«˜é£é™©ç»“æ„ç‰¹å¾ï¼š**
- ç¡åŸºèŠ³é¦™åŒ–åˆç‰©
- å¤ä»£èŠ³é¦™åŒ–åˆç‰©
- é†Œç±»ç»“æ„
- ååº”æ€§ä»£è°¢äº§ç‰©

### åŒ–åˆç‰©åˆ†ç±»çŸ¥è¯†

| åˆ†ç±» | ç‰¹ç‚¹ | ä»£è¡¨åŒ–åˆç‰© | æˆè¯æ€§ |
|------|------|-----------|--------|
| é»„é…®ç±» | æŠ—æ°§åŒ–ã€æŠ—ç‚ | æ§²çš®ç´ ã€èŠ¹èœç´  | ä¸­ç­‰ |
| ç”Ÿç‰©ç¢±ç±» | å¼ºç”Ÿç‰©æ´»æ€§ | å°æª—ç¢±ã€å’–å•¡å›  | é«˜ |
| èœç±» | ç»“æ„å¤šæ · | é’è’¿ç´ ã€ç´«æ‰é†‡ | ä¸­ç­‰ |
| å¼‚é»„é…®ç±» | é›Œæ¿€ç´ æ ·ä½œç”¨ | æŸ“æ–™æœ¨ç´ ã€è‘›æ ¹ç´  | ä¸­ç­‰ |

---

## ç®—æ³•å®ç°

### æ ¸å¿ƒä»£ç ç»“æ„

```java
@Service
public class ScoringService {
    
    public ScoringResultDTO analyze(Long compoundId) {
        // 1. è·å–åŒ–åˆç‰©æ•°æ®
        Compound compound = getCompound(compoundId);
        
        // 2. è·å–è®¡ç®—æ•°æ®ï¼ˆå¯¹æ¥ã€ADMETç­‰ï¼‰
        double affinity = getAffinity(compoundId);
        double hergProb = getHergProbability(compoundId);
        // ...
        
        // 3. å®‰å…¨æ€§æ£€æŸ¥ï¼ˆç†”æ–­ä¼˜å…ˆï¼‰
        if (hergProb > 0.7) {
            return createVetoedResult(compoundId);
        }
        
        // 4. è®¡ç®—ä¸‰å¤§æ¨¡å—åˆ†æ•°
        double safetyScore = calculateSafety(...);
        double potencyScore = calculatePotency(...);
        double druglikenessScore = calculateDruglikeness(...);
        
        // 5. æ±‡æ€»æ€»åˆ†
        double totalScore = safetyScore + potencyScore + druglikenessScore;
        
        // 6. ç”Ÿæˆæ ‡ç­¾å’Œå»ºè®®
        List<String> tags = generateTags(...);
        String advice = generateAdvice(...);
        
        // 7. ä¿å­˜å¹¶è¿”å›
        return createResult(...);
    }
}
```

### æ•°æ®æµ

```
è¾“å…¥æ•°æ®æº
â”œâ”€ Compound è¡¨ (åŸºç¡€ä¿¡æ¯)
â”‚  â”œâ”€ name, englishName
â”‚  â”œâ”€ smiles
â”‚  â”œâ”€ molecularWeight
â”‚  â””â”€ logP
â”‚
â”œâ”€ Docking è¡¨ (å¯¹æ¥ç»“æœ)
â”‚  â”œâ”€ affinity
â”‚  â””â”€ similarity
â”‚
â””â”€ ADMET è¡¨ (æ¯’æ€§é¢„æµ‹)
   â”œâ”€ hergProbability
   â”œâ”€ amesResult
   â””â”€ liverToxicity

â†“ ç®—æ³•å¤„ç† â†“

è¾“å‡ºç»“æœ
â””â”€ ScoringResultDTO
   â”œâ”€ totalScore
   â”œâ”€ potencyScore
   â”œâ”€ safetyScore
   â”œâ”€ druglikenessScore
   â”œâ”€ isVetoed
   â”œâ”€ adviceTags
   â””â”€ expertAdvice
```

---

## è¯„åˆ†ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šä¼˜ç§€åŒ–åˆç‰©

**è¾“å…¥æ•°æ®ï¼š**
```
åŒ–åˆç‰©ï¼šæ§²çš®ç´  (Quercetin)
- åˆ†å­é‡ï¼š302.24 Da
- LogPï¼š1.48
- äº²å’ŒåŠ›ï¼š-9.2 kcal/mol
- ç›¸ä¼¼åº¦ï¼š0.65
- hERGï¼š0.1
- AMESï¼šé˜´æ€§
- è‚æ¯’æ€§ï¼šæ— 
```

**è¯„åˆ†è¿‡ç¨‹ï¼š**

1. **å®‰å…¨æ€§ (35åˆ†)**
   - hERG < 0.3 â†’ 15åˆ† âœ…
   - AMES é˜´æ€§ â†’ 10åˆ† âœ…
   - è‚æ¯’æ€§æ—  â†’ 10åˆ† âœ…
   - **å°è®¡ï¼š35åˆ†**

2. **æ•ˆèƒ½ (45åˆ†)**
   - äº²å’ŒåŠ› -9.2 â†’ 24åˆ†
   - ç›¸ä¼¼åº¦ 0.65 â†’ 5åˆ†
   - LE = 9.2/25 = 0.37 â†’ 5åˆ†
   - **å°è®¡ï¼š34åˆ†**

3. **æˆè¯æ€§ (20åˆ†)**
   - LogP 1.48 â†’ 10åˆ† âœ…
   - MW 302 â†’ 5åˆ† âœ…
   - HBD/HBA ç¬¦åˆ â†’ 5åˆ† âœ…
   - **å°è®¡ï¼š20åˆ†**

**æœ€ç»ˆç»“æœï¼š**
```json
{
  "totalScore": 89.0,
  "potencyScore": 34.0,
  "safetyScore": 35.0,
  "druglikenessScore": 20.0,
  "isVetoed": false,
  "adviceTags": [
    "å¿ƒè„å®‰å…¨æ€§ä½³",
    "ğŸŒŸ æå¼ºç»“åˆ",
    "é«˜é…ä½“æ•ˆç‡",
    "åˆ†å­é‡é€‚ä¸­",
    "è„‚æº¶æ€§é€‚å®œ"
  ],
  "expertAdvice": "è¯¥åŒ–åˆç‰©æ§²çš®ç´ ç»¼åˆè¯„åˆ†ä¼˜ç§€ï¼Œå»ºè®®ä¼˜å…ˆè¿›è¡Œå®éªŒéªŒè¯ã€‚å…·æœ‰è‰¯å¥½çš„æˆè¯æ½œåŠ›ã€‚"
}
```

---

### ç¤ºä¾‹ 2ï¼šç†”æ–­åŒ–åˆç‰©

**è¾“å…¥æ•°æ®ï¼š**
```
åŒ–åˆç‰©ï¼šæµ‹è¯•åŒ–åˆç‰© X
- hERGï¼š0.85 (é«˜é£é™©)
- å…¶ä»–æŒ‡æ ‡ï¼šä¼˜ç§€
```

**è¯„åˆ†è¿‡ç¨‹ï¼š**

1. **å®‰å…¨æ€§æ£€æŸ¥**
   - hERG 0.85 > 0.7 â†’ **è§¦å‘ç†”æ–­** â›”

**æœ€ç»ˆç»“æœï¼š**
```json
{
  "totalScore": 0.0,
  "potencyScore": 0.0,
  "safetyScore": 0.0,
  "druglikenessScore": 0.0,
  "isVetoed": true,
  "adviceTags": ["â›” hERGé«˜å±ç†”æ–­"],
  "expertAdvice": "âŒ ä¸¥é‡è­¦å‘Šï¼šè¯¥åˆ†å­ hERG å¿ƒè„æ¯’æ€§é¢„æµ‹æ¦‚ç‡è¿‡é«˜ (>0.7)ï¼Œå­˜åœ¨è‡´æ­»æ€§å¿ƒå¾‹å¤±å¸¸é£é™©ã€‚æ ¹æ®å®‰å…¨ä¸€ç¥¨å¦å†³åˆ¶ï¼Œç³»ç»Ÿå·²è‡ªåŠ¨ç»ˆæ­¢è¯¥åˆ†å­çš„å¼€å‘æµç¨‹ã€‚"
}
```

---

### ç¤ºä¾‹ 3ï¼šä¸­ç­‰åŒ–åˆç‰©

**è¾“å…¥æ•°æ®ï¼š**
```
åŒ–åˆç‰©ï¼šåŒ–åˆç‰© Y
- åˆ†å­é‡ï¼š450 Da
- LogPï¼š3.5
- äº²å’ŒåŠ›ï¼š-7.5 kcal/mol
- hERGï¼š0.4
- AMESï¼šé˜³æ€§
```

**è¯„åˆ†è¿‡ç¨‹ï¼š**

1. **å®‰å…¨æ€§ (35åˆ†)**
   - hERG 0.4 â†’ 5åˆ† âš ï¸
   - AMES é˜³æ€§ â†’ 0åˆ† âŒ
   - è‚æ¯’æ€§æ—  â†’ 10åˆ† âœ…
   - **å°è®¡ï¼š15åˆ†**

2. **æ•ˆèƒ½ (45åˆ†)**
   - äº²å’ŒåŠ› -7.5 â†’ 11.25åˆ†
   - ç›¸ä¼¼åº¦ 0.55 â†’ 5åˆ†
   - LE ä¸è¶³ â†’ 0åˆ†
   - **å°è®¡ï¼š16.25åˆ†**

3. **æˆè¯æ€§ (20åˆ†)**
   - LogP 3.5 â†’ 6åˆ†
   - MW 450 â†’ 5åˆ† âœ…
   - HBD/HBA ç¬¦åˆ â†’ 5åˆ† âœ…
   - **å°è®¡ï¼š16åˆ†**

**æœ€ç»ˆç»“æœï¼š**
```json
{
  "totalScore": 47.3,
  "potencyScore": 16.3,
  "safetyScore": 15.0,
  "druglikenessScore": 16.0,
  "isVetoed": false,
  "adviceTags": [
    "hERGé£é™©ä¸­ç­‰",
    "è‡´çªå˜é£é™©",
    "ç»“åˆåŠ›ä¸­ç­‰"
  ],
  "expertAdvice": "è¯¥åŒ–åˆç‰©ç»¼åˆè¯„åˆ†è¾ƒä½ï¼Œä¸å»ºè®®ä½œä¸ºå€™é€‰è¯ç‰©ï¼Œéœ€è¦å¤§å¹…åº¦ç»“æ„æ”¹é€ ã€‚ç‰¹åˆ«éœ€è¦å…³æ³¨å®‰å…¨æ€§é—®é¢˜ã€‚"
}
```

---

## ç®—æ³•ä¼˜åŒ–å»ºè®®

### å½“å‰ç‰ˆæœ¬çš„å±€é™æ€§

1. **æ¨¡æ‹Ÿæ•°æ®**ï¼šå½“å‰ä½¿ç”¨ç¡¬ç¼–ç çš„æ¨¡æ‹Ÿå€¼
2. **ç®€åŒ–è®¡ç®—**ï¼šéƒ¨åˆ†å‚æ•°ï¼ˆå¦‚ HBD/HBAï¼‰ä½¿ç”¨ä¼°ç®—
3. **å•ä¸€é¶ç‚¹**ï¼šä»…è€ƒè™‘ CDK2 é¶ç‚¹

### æœªæ¥æ”¹è¿›æ–¹å‘

1. **é›†æˆçœŸå®è®¡ç®—æ¨¡å—**
   - å¯¹æ¥ï¼šAutoDock Vina
   - ADMETï¼špkCSM, SwissADME
   - ç›¸ä¼¼æ€§ï¼šRDKit Tanimoto

2. **æœºå™¨å­¦ä¹ å¢å¼º**
   - ä½¿ç”¨ ML æ¨¡å‹é¢„æµ‹ hERGã€AMES
   - è®­ç»ƒæ•°æ®ï¼šChEMBL, PubChem

3. **å¤šé¶ç‚¹æ”¯æŒ**
   - CDK4/6
   - EGFR
   - å…¶ä»–æ¿€é…¶

4. **åŠ¨æ€æƒé‡è°ƒæ•´**
   - æ ¹æ®ç–¾ç—…ç±»å‹è°ƒæ•´æƒé‡
   - ç”¨æˆ·è‡ªå®šä¹‰è¯„åˆ†ç­–ç•¥

---

## å‚è€ƒæ–‡çŒ®

1. Lipinski, C. A. (2004). Lead- and drug-like compounds: the rule-of-five revolution. *Drug Discovery Today: Technologies*, 1(4), 337-341.

2. Hopkins, A. L., Groom, C. R., & Alex, A. (2004). Ligand efficiency: a useful metric for lead selection. *Drug Discovery Today*, 9(10), 430-431.

3. Sanguinetti, M. C., & Tristani-Firouzi, M. (2006). hERG potassium channels and cardiac arrhythmia. *Nature*, 440(7083), 463-469.

4. Ames, B. N., Durston, W. E., Yamasaki, E., & Lee, F. D. (1973). Carcinogens are mutagens: a simple test system combining liver homogenates for activation and bacteria for detection. *PNAS*, 70(8), 2281-2285.

5. Trott, O., & Olson, A. J. (2010). AutoDock Vina: improving the speed and accuracy of docking with a new scoring function. *Journal of Computational Chemistry*, 31(2), 455-461.

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0.0  
**æœ€åæ›´æ–°ï¼š** 2026-01-19  
**ç»´æŠ¤è€…ï¼š** è¯ç‰©ç­›é€‰å¹³å°å¼€å‘å›¢é˜Ÿ
